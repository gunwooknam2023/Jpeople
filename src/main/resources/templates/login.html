<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>로그인</title>
    <link rel="icon" href="data:;base64,iVBORw0KGgo=">
    <link rel="stylesheet" href="/css/login.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
</head>
<body>

<!-- 하단바 -->
<div class="footer">
    대표: 남건욱
</div>


<form class="form-container">
    <div style="font-size: 30px">J PEOPLE</div>
    <br>
    <div class="mb-3">
        <label for="username" class="form-label">아이디</label>
        <input type="text" class="form-control" id="username" aria-describedby="emailHelp">
    </div>
    <div class="mb-3">
        <label for="password" class="form-label">비밀번호</label>
        <input type="password" class="form-control" id="password">
    </div>
    <div>
        <button type="button" class="btn btn-secondary">회원가입</button>
        <button type="button" class="btn btn-primary" onclick="login()">로그인</button>
    </div>
    <div>
        <button type="button" id="login-kakao-btn"
                onclick="location.href='https://kauth.kakao.com/oauth/authorize?client_id=e2b5dd62d59425073e3237f399d2da33&redirect_uri=http://localhost:8080/api/user/kakao/callback&response_type=code'">
            KakaoTALK
        </button>
    </div>

</form>

<script>

    function login() {
        var username = document.getElementById('username').value;
        var password = document.getElementById('password').value;

        var loginRequestDto = {
            username: username,
            password: password
        };

        var xhr = new XMLHttpRequest();
        xhr.open('POST', '/api/login', true);
        xhr.setRequestHeader('Content-Type', 'application/json');
        xhr.onload = function () {
            if (xhr.status >= 200 && xhr.status < 410) {
                var responseText = xhr.responseText;
                console.log(responseText); // 응답 문자열 출력
                if (xhr.status === 200) { // 성공
                    window.location.href = '/';
                } else if (xhr.status >= 400) { // 로그인 실패
                    alert('로그인 실패. 다시 시도하세요.');
                    window.location.href = '/api/view/login';
                }
            } else {
                console.error('Error:', xhr.status, xhr.statusText);
            }
        };
        xhr.onerror = function () {
            console.error('Network Error');
        };
        xhr.send(JSON.stringify(loginRequestDto));
    }


</script>


</body>
</html>